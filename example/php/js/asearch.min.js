var searchAjax={History:{},useHistory:!0,init:function(e){this.input=document.querySelector(e.input),this.resultStream=document.querySelector(e.resultsHolder),this.template=e.template,this.url=e.url,null==this.input||null==this.resultStream||null==this.template||null==this.url||(this.XMLHTTPObject=new XMLHttpRequest,this.input.onkeydown=this.keyListener,this.input.addEventListener("input",this.textInput),this.input.addEventListener("blur",function(e){}))},keyListener:function(e){switch(e.keyCode){case 38:e.preventDefault(),searchAjax.activePrev(e);break;case 40:e.preventDefault(),searchAjax.activeNext(e)}},textInput:function(e){var t=e.target.value.trim();return""==t?searchAjax.updateDisplay([]):void(void 0===searchAjax.History[t]?searchAjax.search(t):(console.log("from history"),searchAjax.updateDisplay(searchAjax.History[t])))},activePrev:function(e){var t=searchAjax.resultStream.querySelector(".active"),a=t.previousSibling;null===a||(t.classList.remove("active"),a.classList.add("active"),searchAjax.updateInput(a),a.scrollIntoView(!1))},activeNext:function(e){var t=searchAjax.resultStream.querySelector(".active"),a=t.nextSibling;null===a||(t.classList.remove("active"),a.classList.add("active"),searchAjax.updateInput(a),a.scrollIntoView(!1))},updateInput:function(e){searchAjax.input.value=e.querySelector(".name").textContent},render:function(e,t){for(var a=e.match(/{([a-z1-9\s]+)+}/g),r=a.map(function(e){return e.replace(/{|}/g,"")}),s=0;s<a.length;s++)e=e.replace(a[s],t[r[s].trim()]);return searchAjax.toHtmlDom(e)},toHtmlDom:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0]},updateDisplay:function(e){searchAjax.resultStream.innerHTML="",e.forEach(function(e){searchAjax.resultStream.appendChild(searchAjax.render(searchAjax.template,e))}),e.length&&searchAjax.resultStream.firstChild.classList.add("active")},search:function(e){(0==searchAjax.XMLHTTPObject.readyState||4==searchAjax.XMLHTTPObject.readyState)&&(searchAjax.XMLHTTPObject.open("GET",searchAjax.url+e),searchAjax.XMLHTTPObject.onreadystatechange=function(){if(200==searchAjax.XMLHTTPObject.status&&4==searchAjax.XMLHTTPObject.readyState){var t=JSON.parse(searchAjax.XMLHTTPObject.responseText);searchAjax.useHistory&&(searchAjax.History[e]=t),searchAjax.updateDisplay(t)}},searchAjax.XMLHTTPObject.send())}};